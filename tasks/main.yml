# 1 prepare for installation
- name: Install psycopg2 for Ansible PostgreSQL module
  pip:
    name: [psycopg2-binary,psycopg2]
    
- name: Create PostgreSQL Databases Directory
  file:
    path: /data/pgsql
    state: directory
    owner: postgres
    group: postgres
    mode: 0700

#2 install by OS family    
- include: "{{ansible_os_family}}.yml"

#3 configure

#4 display version and service state of components
- name: Get MongoDB version
  shell: sudo sh -c "psql -V  1>> /data/logs/install_version.txt"

- name: Check PostgreSQL Service
  shell: systemctl status postgresql | grep Active*
  register: check_postgresql_service
  notify: check_postgresql_service
